<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Zero-Shot Machine-Generated Image Detection using Sinks of Gradient Flows | 6.S898 Deep Learning Blogs 2023</title> <meta name="author" content="abc b c"/> <meta name="description" content="How can we detect fake images online? A novel approach of characterizing the behavior of a diffusion model's learned score vectors."/> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="stylesheet" href="/staging/assets/css/main.css"> <link rel="canonical" href="https://deep-learning-mit.github.io/staging/blog/2023/detect-image/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/staging/assets/js/theme.js"></script> <script src="/staging/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/staging/assets/js/distillpub/template.v2.js"></script> <script src="/staging/assets/js/distillpub/transforms.v2.js"></script> <script src="/staging/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <d-front-matter> <script async type="text/json">{
      "title": "Zero-Shot Machine-Generated Image Detection using Sinks of Gradient Flows",
      "description": "How can we detect fake images online? A novel approach of characterizing the behavior of a diffusion model's learned score vectors.",
      "published": "November 8, 2023",
      "authors": [
        {
          "author": "Marvin Li",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Harvard",
              "url": ""
            }
          ]
        },
        {
          "author": "Jason Wang",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Harvard",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/staging/">6.S898 Deep Learning Blogs 2023</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/staging/blog/index.html">blog</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">past iterations</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="https://iclr-blog-track.github.io/home/">2022</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Zero-Shot Machine-Generated Image Detection using Sinks of Gradient Flows</h1> <p>How can we detect fake images online? A novel approach of characterizing the behavior of a diffusion model's learned score vectors.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#project-proposal">Project Proposal</a></div> </nav> </d-contents> <h4 id="project-proposal">Project Proposal</h4> <p>As AI-generated images become ever more widespread, garnering virality for how realistic they have become, we are increasingly concerned with the potential for misuse. For example, a deluge of machine-generated fake images could spread misinformation and harmful content on social media. Consequently, a growing body of research has sought to develop technqiues to distinguish between the real and the synthetic.</p> <p>In this project, we are interested in developing techniques to detect images generated from diffusion models, the most prevalent image generation architecture. In particular, we are inspired by ideas from DetectGPT <d-cite key="mitchell2023detectgpt"></d-cite>, a recent work which addressed the same problem of detecting AI-generated content, but in the setting of large language models. For a given piece of text, DetectGPT perturbs the original text and computes the difference in log-likelihood between the perturbed text and the original text:</p> \[\mathrm{DetectGPT}(x,p_{\theta},q)\triangleq\log p_{\theta}(x)-\mathbb{E}_{\tilde{x}\sim q(\cdot|x)}\log p_{\theta}(\tilde{x})\] <p>where \(p_\theta\) is the language model and \(q\) is the distribution of perturbations. If the difference in log-likelihood is large, then the attack claims that the original text is more likely to be generated by a language model. We are interested in extending this idea to develop a similar method for diffusion models.</p> <p>There are several critical differences between language models and diffusion models. With text, one can directly compute the log likelihood of a given piece of text, even with only blackbox access, i.e., no visibility to the model’s parameters. In contrast, for diffusion models, it is intractable to directly compute the probability distribution over images because diffusion models only learn the score. Moreover, the most commonly used diffusion models, e.g. DALL-E 3, apply the diffusion process to a latent embedding space rather than the pixel space. To address the latter concern, we plan on applying the encoder to the image to obtain an approximation of the embedding that was passed into the decoder. And to address the former, instead of approximating the probability curvature around a given point like DetectGPT, we formulate a statistic characterizing whether the gradient field/score is a sink, i.e., the gradients around a machine-generated image point to the machine-generated image. This captures the idea of a local maximum in probability space, similar to the DetectGPT framework. In particular, we would like to compute the divergence of the diffusion model’s score field around the image (negative divergence indicates a sink). We can estimate this via a finite-differencing approach: given a diffusion model $s_\theta(x)$ which predicts the score $\nabla_x\log p_\theta(x)$, we have that</p> \[\mathrm{div}(s_\theta,x)\approx \sum_{i=1}^d \frac{s_\theta(x+he_i)-s_\theta(x-he_i)}{2h}\] <p>for \(h\) small enough and $\{e_i\}_{i=1}^d$ an orthonormal basis. However, images tend to be incredibly high-dimensional, which means that this sum could be computationally expensive; although, for models that apply the diffusion process on the latent embedding space this may be more feasible. Alternatively, we can get a characterization of the score field by noising the image/latent, and then denoising with the diffusion models and measuring the average distance back to the original data point. That is, given a diffusion model \(f_\theta\) which takes a noised image and outputs an unnoised image (abstracting away noise schedulers, etc. for clarity),</p> \[\mathrm{DetectImage}(f_{\theta},x)\triangleq \mathbb{E}_{\tilde{x}\sim \mathcal{N}(x,\epsilon)}||x-f_{\theta}(\tilde{x})||_2\] <p>for \(\epsilon\) small enough (though it might be interesting to characterize across different \(\epsilon\)).</p> <p>Previous literature has considered several different methods for image detection. Sha et al. 2023 <d-cite key="sha2022fake"></d-cite> trained machine learning classifiers to detect fake images using high-level image and text embeddings. They, however, do not consider the local information around image embeddings, and require existing datasets of known image-generated and non-image-generated examples to train their classifier. Corvi et al. 2023 <d-cite key="corvi2023detection"></d-cite> identified “forensic traces” in machine-generated image residuals for this task. Again, their method requires many data samples, and performs much worse on diffusion models than GANs. In principle, as with DetectGPT, our score-based image detection algorithm will be zero-shot, will require no additional datasets (beyond evaluating the performance), and will be generalizable across different diffusion models.</p> <p>Our project plan is thus the following:</p> <ol> <li><em>Dataset.</em> We plan to use the DiffusionDB dataset <d-cite key="wang2022diffusiondb"></d-cite>, a dataset of 14M (prompt, image) pairs generated by the open-source Stable Diffusion Version 1 model <d-cite key="rombach2022high"></d-cite>. We then use the MSCOCO dataset <d-cite key="lin2014microsoft"></d-cite>, a dataset of 330K non-machine generated images, which was used by Sha et al. <d-cite key="sha2022fake"></d-cite> in their evaluation.</li> <li><em>Implementation.</em> We will implement the two proposed statistics that uses the score information around generated images to predict whether it was generated by a model. We will also continue to look at existing definitions/characterizations of sinks in existing literature. Then, we will rigorously test over the size of the neighborhood to examine to determine the best parameters for the method.</li> <li><em>Comparison.</em> We plan to compare our method to the existing methods we mentioned before. In each case, we want to calculate the accuracy and full AUC-ROC curve, and in particular, we are concerned with the low FPR rates where we are quite sure an image is fake. We also want to test the robustness of our method to random image cropping, noising, reflections, rotations, and compression. We plan to run image augmentations over both our datasets and report the same metrics over these augmentations.</li> </ol> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/staging/assets/bibliography/2023-11-08-detect-image.bib"></d-bibliography> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2023" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>