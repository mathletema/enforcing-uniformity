<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>(Proposal) Physics-informed Learning for Chaotic Dynamics Prediction | 6.S898 Deep Learning Blogs 2023</title> <meta name="author" content="abc b c"/> <meta name="description" content="Project proposal submission by Sunbochen Tang."/> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="stylesheet" href="/staging/assets/css/main.css"> <link rel="canonical" href="https://deep-learning-mit.github.io/staging/blog/2023/Physics-informed-learning-chaotic-dynamics/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/staging/assets/js/theme.js"></script> <script src="/staging/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/staging/assets/js/distillpub/template.v2.js"></script> <script src="/staging/assets/js/distillpub/transforms.v2.js"></script> <script src="/staging/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <d-front-matter> <script async type="text/json">{
      "title": "(Proposal) Physics-informed Learning for Chaotic Dynamics Prediction",
      "description": "Project proposal submission by Sunbochen Tang.",
      "published": "November 10, 2023",
      "authors": [
        {
          "author": "Sunbochen Tang",
          "authorURL": "",
          "affiliations": [
            {
              "name": "MIT AeroAstro",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/staging/">6.S898 Deep Learning Blogs 2023</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/staging/blog/index.html">blog</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">past iterations</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="https://iclr-blog-track.github.io/home/">2022</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>(Proposal) Physics-informed Learning for Chaotic Dynamics Prediction</h1> <p>Project proposal submission by Sunbochen Tang.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#project-overivew">Project Overivew</a></div> <div><a href="#problem-formulation">Problem Formulation</a></div> <ul> <li><a href="#a-motivating-example">A motivating example</a></li> <li><a href="#physics-informed-modeling">Physics-informed modeling</a></li> </ul><div><a href="#project-scope">Project Scope</a></div> <div><a href="#research-project-disclaimers">Research Project Disclaimers</a></div> </nav> </d-contents> <h2 id="project-overview">Project Overview</h2> <p>In this project, we would like to explore how to incorporate physics-based prior knowledge in to machine learning models for dynamical systems. Traditionally, physics laws have been used to model system behaviors with a set of differential equations, e.g. using Newton’s second law to derive a pendulum equation of motion, or using Navior Stoke’s equations to describe air flow in space. However, such physics-based modeling methods become challenging to implement for complex systems as all physics-based models come with assumption that helps simplify the scenario to certain extent. In recent years, machine learning has shown great potentials for developing data-driven modeling methods <d-cite key="brunton2022data"></d-cite>.</p> <p>Although learning-based methods have shown their capability of generating accuracy prediction of dynamical systems, the learned representations are difficult to interpret, especially when general multi-layer perceptron (MLP) or recurrent neural network (RNN) are used to construct the estimator. Apart from an accurate prediction, interpretability is also desirable as it helps us understand the limitation of such models. Furthermore, if a model can be constructed in line with physical modeling principles, ideally it might reveal more structured information about the data we collected from a given system. One might even hope an interpretable machine learning model would give us new insights about how to construct efficient models and discover new physics properties about a dynamical system from data.</p> <p>To narrow the scope of the problem for feasibility of this course project, we will focus on the long-term prediction problem for a deterministic chaotic system, Lorenz 63, first proposed and studied in E. N. Lorenz’s seminal paper <d-cite key="lorenz1963deterministic"></d-cite>. This system can be described in closed-form as a set of ordinary differential equations (ODE) with three variables, which makes the learning problem less data hungry and easier to train neural networks for its prediction with limited computation power. Despite the chaotic nature of the system (meaning that a small perturbation to the system can lead to exponential divergence in time from its original trajectory), the state of Lorenz 63 stays on a “strange attractor”” (a bounded set in the state space as shown in the animation below). We refer to the fact that the trajectory stays on the attractor as the “long-term” stability of Lorenz 63. Such long-term stability is desirable for any predictor as it indicates learning about statistical behavior of the system. Methods that can guarantee such long-term stability based on machine learning have not appeared so far, but theoretical guarantees are highly desirable as they are part of the intrinsic system properties and indicate meaningfulness of our learnt representations. Furthermore, Lorenz 63 is a simplified version of complex atmosphere thermodynamics models which are crucial in climate studies or weather forecasting. Starting with Lorenz 63 is a meaningful gateway to studying physics-informed learning approaches for climate models.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Lorenz63-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Lorenz63-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Lorenz63-1400.webp"/> <img src="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Lorenz63.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> By simulating the closed-form ODE of Lorenz 63, it is observed that the trajectory always stay in the bounded region formed by these white-colored "orbits", the region is also known as the "strange attractor" of Lorenz 63. (The butterfly shape is beautiful!) </div> <p>Focused on the specific Lorenz 63 system, the objective of this project is to explore machine learning model structures that attempt to achieve two goals: (1) High prediction accuracy of the state trajectory (2) Provide theoretical guarantees for long-term stability, i.e., predicted trajectory stays on the “strange attractor”. In the literature, there has been approaches that use certain empirical methods to encourage long-term stability such as using noise regularization <d-cite key="wikner2022stabilizing"></d-cite>. However, such methods do not offer any theoretical guarantees and are generally difficult to interpret. We aim to investigate a specific model construction that incorporates “energy” information of the system, analogous to a recent approach in stability-guaranteed learning-based approach in control theory <d-cite key="min2023data"></d-cite>. On a high level, the proposed approach tries to learn both a predictor for Lorenz 63 and a “energy” function, and constructs a neural network for the predictor with specific activation functions such that it is constrained to a non-increasing energy condition (we will provide a more detailed description in the next section). The goal is to investigate whether this idea works on Lorenz 63 system, what type of structure we need to impose on the neural network to achieve both goals, and whether constraining the network structure leads to a trade-off between the theoretical guarantees and prediction accuracy.</p> <h2 id="problem-formulation">Problem Formulation</h2> <p>Consider a general continnuous-time nonlinear dynamics system (we will use continuous-time dynamical system formulation throughout the project):</p> \[\dot{s}(t) = f(s(t)), s(t) \in \mathbb{R}^n\] <p>The objective of a general prediction problem is to learn a neural network-based function approximator \(g: \mathbb{R}^n \to \mathbb{R}^n\) such that the ODE \(\dot{s}(t) = g(s(t))\) approximates the true system above well. Namely, suppose we simulate both ODEs from the same initial condition \(r(0) = s(0)\), we want the predicted trajectory \(r(t)\), which is generated by \(\dot{r}(t) = g(r(t))\) to approximate \(x(t)\) well, i.e., \(\sup_{t \geq 0} \|r(t) - s(t)\|\) to be small.</p> <p>Specifically, here we consider the Lorenz 63 system, which can be described as (here \(x, y, z\) are scalar variables)</p> \[\begin{align*} \dot{x} &amp;= \sigma (y-x)\\ \dot{y} &amp;= x(\rho - z) - y\\ \dot{z} &amp;= xy - \beta z \end{align*}\] <p>where \(\sigma, \rho, \beta\) are scalar parameters for the system. We choose \(\sigma=10, \beta=8/3, \rho=28\) as they generate chaotic behaviors and still observe long-term stability.</p> <h3 id="a-motivating-example">A motivating example</h3> <p>We first consider a set of motivating numerical experiments which build a simple 3-layer MLP as a predictor for discrete-time Lorenz 63 to assess how difficult it is to approximate the dynamics. (Apologies for potential confusions, we use discrete-time systems because it’s easier to set up, but we will use continuous-time systems in the project.) The discrete-time system is numerically integrated from the continuous-time version using 4th order Runge-Kutta method (RK4) sampled at a fixed time step \(\Delta t\), which is in the form of</p> \[s[k+1] = f_d(s[k]), s[k] = s(k\Delta t) \in \mathbb{R}^3\] <p>We generate a dataset by sampling \(N\) one-step pair \((s[k], s[k+1]), k = 0, 1, 2, ..., N-1\) from a single long trajectory using the discrete-time dynamics. A 3-layer MLP \(g(s[k]; \theta)\) (parameterized by weights \(\theta\)) is trained to minimize the MSE loss via SGD, i.e.,</p> \[\min_{\theta} \frac{1}{N} \sum_{k=0}^{N-1} \|s[k+1] - g(s[k]; \theta)\|_2^2\] <p>During testing, we choose a initial condition \(s[0]\), different than the one used to generate the training data, and generate a ground-truth trajectory of step \(N\) as the testing dataset \(\{s[n]\}_{n=0}^{N-1}\) and use the trained network by generating two separate trajectories as follows:</p> <ol> <li> <p>“MLP One-step”: we apply the network to the ground-truth \(s[n]\) at every step, i.e., the trajectory \(s_1[n]\) that we generate satisfies \(s_1[0] = s[0]\) and \(s_1[k+1] = g(s[k])\).</p> </li> <li> <p>“MLP Feedback”: we set the initial condition \(s_2[0] = s[0]\) and apply the network prediction iteratively, i.e., \(s_2[k+1] = g(g(... g(s[0])))\) where \(g\) is applied \(k\) times.</p> </li> </ol> <p>To reduce the length of this post, we only present two most relevant examples here. When we have a dataset of \(N=1000\) sampled one-step pairs, using GeLU activation, we are able to achieve very good prediction accuracy in both cases and both trajectories observe the “strange attractor” long-term stability as desired.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_1000-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_1000-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_1000-1400.webp"/> <img src="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_1000.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Both prediction accuracy and long-term stability achieved when $$N=1000$$. </div> <p>However, when we reduce the dataset to \(N=100\) sampled one-step pairs, using the same GeLU activation, the “MLP feedback” trajectory fails to make accurate prediction and long-term stability. Meanwhile, the “MLP one-step” trajectory still makes very good one-step prediction. This implies that the training problem is solved almost perfectly, however, due to the nature of chaotic dynamics, a little divergence from the true dynamics, when rolled out in \(N\) steps (as in the setting of “feedback”), it diverge from the true trajectory very quickly.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_100-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_100-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_100-1400.webp"/> <img src="/staging/assets/img/2023-11-10-Physics-informed-learning-chaotic-dynamics/Gelu_100.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> When $$N=100$$, "MLP feedback" fails while the training problem is solved well. (the blue and green trajectories overlap with each other) </div> <p>Although there are more advanced ways of learning a time-series data like this, e.g., RNNs, this simplified exercise illustrates the difficulty of learning an underlying structure of dynamics (rolling out the trajectory iteratively) compared to fitting data to achieve near-zero MSE loss (one-step prediction), especially when data is limited.</p> <p>The setup of “feedback” is meaningful in a practical sense. For applications such as climate modeling, we typically want to learn what would happen in the future (in months/years), therefore, we cannot use a “one-step” prediction setup where we are restricted to predicting events in a very small future time window.</p> <h3 id="physics-informed-modeling">Physics-informed modeling</h3> <p>As mentioned in the previous section, we aim to explore physics-informed network structures that impose certain physical constraints, with a focus on developing a method similar to the one proposed in <d-cite key="min2023data"></d-cite>. Here in the proposal, we will give a quick outline of what this approach might look like (The actual approach will be developed fully in this project).</p> <p>If we look back on the Lorenz 63 equation (continuous-time), it is not difficult to see that on the right hand side, we have a second-order polynomial of the state. Therefore, if we consider the following energy function \(V\) and write out its time derivative \(\dot{V} = dV/dt = \partial V/\partial [x, y, z] [\dot(x), \dot(y), \dot(z)]^T\), we have</p> \[\begin{align*} V &amp;= \rho x^2 + \sigma y^2 + \sigma(z - 2\rho)^2\\ \dot{V} &amp;= -2\sigma( \rho x^2 + y^2 + \beta(z-\rho)^2 - \beta \rho^2) \end{align*}\] <p>Note that \(V\) is always a non-negative function, and outside an ellipsoid \(E = \{(x, y, z): \rho x^2 + y^2 + \beta (z - \rho)^2 \leq \beta \rho^2\}\), \(\dot{V}\) is always smaller than 0, i.e., \(\forall (x, y, z) \not\in E\), \(\dot{V}(x, y, z) &lt; 0\).</p> <p>This is actually one interpretation why the Lorenz 63 system always stay on a bounded “strange attractor”, because its trajectory always loses energy when it is outside the set \(E\). Conceptually, the trajectory will always return to a certain energy level after it exits \(E\).</p> <p>Suppose we can construct a neural network \(g\) for the continuous-time dynamics and another neural network \(h\) for the energy function \(V(x, y, z)\), i.e.,</p> \[(\hat{\dot{x}}, \hat{\dot{y}}, \hat{\dot{z}}) = g( x, y, z ; \theta_g), \quad \hat{V}(x, y, z) = h( x, y, z ; \theta_h)\] <p>In a very similar context, <d-cite key="min2023data"></d-cite> developes a specific neural network structure for \(h\) that can ensure</p> \[\dot{h} = (\partial h(x, y, z; \theta)/\partial (x, y, z)) \cdot g(x, y, z; \theta_g) &lt; -\alpha h(x, y, z; \theta)\] <p>where \(\alpha &gt; 0\) is a positive scalar (for interested readers, this condition defines a Lyapunov function in control theory).</p> <p>In this project, we aim to develop a similar structure to ensure a slightly different (local) condition:</p> <p>\(\forall (x, y, z) \not\in E\), \(\dot{\hat{V}}(x, y, z) &lt; 0\).</p> <p>which constaints the learned model to satisfy a physical property of the system by construction. With such constraints implemented by construction, we can use the MSE loss similar to the motivating example to train both \(g\) and \(h\) simultaneously. Hopefully this would lead us to learning a network that achieves high prediction accuracy while obeying physical constraints.</p> <h2 id="project-scope">Project Scope</h2> <p>In the previous section, we gave an outline about why we want to investigate physics-based modeling for Lorenz 63 and what specific physical system information we would like to incorporate. Although we plan to spend a decent amount of time to implement and test the specific method mentioned previously, we would like to reiterate the project objective and its possible relevance to this course in this section.</p> <p>The project’s general objective is to investigate how to learn meaningful physics-informed representations and build constrained machine learning models that ensure certain physical properties. Picking the specific problem and approach helps us focus on a more concrete problem, but it does not restrict the project to implementation of this specific method.</p> <p>More importantly, since the proposed method uses specific activation functions in <d-cite key="min2023data"></d-cite> to impose physical constraints, it restricts our model to a smaller class defined by such constraints. There could be several interesting questions downstream to be investigated:</p> <ul> <li>Would the constrained class of models be able to achieve high prediction accuracy?</li> <li>Is there a trade-off between physics constraint satisfaction (model class) and prediction accuracy (minimizing MSE loss)?</li> <li>Does the physics-informed model provide acceptable prediction accuracy in the limited data regime?</li> <li>After training, what does the \(h\) network learn? Does it resemble an energy function?</li> </ul> <p>Furthermore, we would also perform a short literature review to survey other physics-informed learning methods for dynamical systems. If we find a highly relevant approach that would work for problem, under the time constraint of the project, we will try to implement such approaches and compare our approach with them as well.</p> <h2 id="research-project-disclaimers">Research Project Disclaimers</h2> <p>I would like to inform the teaching staff that this project is planned to be part of my ongoing research. During the semester, I don’t have much time to work on this idea as I am trying to meet a conference deadline for another ongoing project. Since the project explores learning efficient physical representations for dynamical system, I am hoping that I can use the course project opportunity to work on this idea. There has not been much prior work done except the thought process presented in this proposal. If the specific approach proposed turns out to be successful, I would like to extend it into my next research project and hopefully part of my Ph.D. thesis.</p> <p>Please let me know if this would be acceptable under the course guideline. I’d be happy to make other modifications to follow the course project guideline on using ideas relevant to ongoing/future research.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/staging/assets/bibliography/2023-11-10-Physics-informed-learning-chaotic-dynamics.bib"></d-bibliography> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2023" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>